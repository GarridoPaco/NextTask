const mobileMenuBtn=document.querySelector("#mobileMenuBtn"),mobileCloseBtn=document.querySelector("#mobileCloseBtn"),sidebar=document.querySelector(".sidebar");mobileMenuBtn&&mobileMenuBtn.addEventListener("click",(function(){sidebar.classList.add("show"),console.log("menu mobile")})),mobileCloseBtn&&mobileCloseBtn.addEventListener("click",(function(){sidebar.classList.add("hide"),sidebar.classList.remove("show"),sidebar.classList.remove("hide")}));const anchoPantalla=document.body.clientWidth;window.addEventListener("resize",(function(){document.body.clientWidth>=768&&sidebar.classList.remove("show")}));const navViews=document.querySelector("#navViews"),barra=document.querySelector(".barra");navViews||(barra.style.borderRadius="1rem");const closeModalBtns=document.querySelectorAll(".closeModal");function formatDate(e){const t=new Date(e),n=t.getMonth(),s=t.getDate(),a=t.getFullYear();return new Date(Date.UTC(a,n,s)).toLocaleDateString("es-Mx",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function closeModal(){document.querySelectorAll(".modal-overlay").forEach((function(e){e.style.display="none"}))}function showContentTask(){document.querySelectorAll(".toggleBtn").forEach((function(e){e.addEventListener("click",(function(){const t=this.nextElementSibling;t.classList.toggle("active"),t.classList.contains("active")?e.src="build/img/up_arrow_icon.svg":e.src="build/img/down_arrow_icon.svg"}))}))}function taskActionsMenu(){document.querySelectorAll(".taskActionsBtn").forEach((function(e){e.addEventListener("click",(function(){const t=this.nextElementSibling;t.classList.toggle("active"),t.classList.contains("active")?e.src="build/img/right_arrow_icon.svg":e.src="build/img/dots_three_circle_icon.svg"}))}))}function showAlert(e,t){const n=document.querySelector(".alerta");n&&n.remove();const s=document.createElement("DIV");s.classList.add("alerta",t),s.textContent=e;const a=document.querySelector("legend");a.parentElement.insertBefore(s,a.nextElementSibling),setTimeout(()=>{s.remove()},5e3)}async function taskBin(e,t,n,s,a,i,o){return new Promise(async c=>{const d=document.createElement("LI");d.dataset.taskId=t.id,d.classList.add("taskContainer");const l=document.createElement("input");l.type="checkbox",l.classList.add("checkTask"),l.disabled=!0;const r=document.createElement("DIV");r.classList.add("taskHeader"),r.appendChild(l);const m=document.createElement("P");m.textContent=t.title,m.classList.add("taskName"),r.appendChild(m);const u=document.createElement("IMG");u.classList.add("toggleBtn"),u.classList.add("actionImg"),u.alt="Desplegar contenido",u.title="Mostrar información adicional",u.src="build/img/down_arrow_icon.svg";const p=document.createElement("DIV");p.classList.add("taskContentContainer");const g=document.createElement("DIV");g.classList.add("taskInfo");const C=document.createElement("DIV");C.classList.add("taskDescription");const h=document.createElement("IMG");h.classList.add("taskDescriptionIcon"),h.alt="Descripción de la tarea",h.src="build/img/info_icon.svg",C.appendChild(h);const k=document.createElement("P");k.classList.add("taskDescriptionText"),""===t.description?k.textContent="Sin descripción":k.textContent=t.description,C.appendChild(k),g.appendChild(C);const y=document.createElement("DIV");y.classList.add("taskPriority");const E=document.createElement("DIV");E.classList.add("taskPriorityColor");E.style.backgroundColor=["#82E0AA","#F7DC6F","#F1948A"][t.priority],y.appendChild(E);const L=document.createElement("P");L.classList.add("taskPriorityText");L.textContent="Prioridad "+["Baja","Normal","Alta"][t.priority],y.appendChild(L),g.appendChild(y);const b=document.createElement("DIV");b.classList.add("taskStatus");const f=document.createElement("IMG");f.classList.add("taskStatusIcon");f.alt="Imagen del estado de la tarea",f.src=["build/img/pendiente_icon.svg","build/img/progress_icon.svg","build/img/complete_icon.svg"][t.status],b.appendChild(f);const v=document.createElement("P");v.classList.add("taskStatusText");v.textContent=""+["Pendiente","En Progreso","Finalizada"][t.status],b.appendChild(v),g.appendChild(b);const w=document.createElement("DIV");w.classList.add("taskActionsContainer");const I=document.createElement("DIV");I.classList.add("taskActions");const _=document.createElement("IMG");_.title="Menú de acciones",_.src="build/img/dots_three_circle_icon.svg",_.classList.add("taskActionsBtn"),_.classList.add("actionImg");const B=document.createElement("IMG");B.title="Editar tarea",B.src="build/img/edit_icon.svg",B.classList.add("editTaskBtn"),B.classList.add("actionImg"),B.onclick=function(){editTaskModal(e,t,i,o)};const D=document.createElement("IMG");D.title="Eliminar tarea",D.src="build/img/delete_icon.svg",D.classList.add("deleteTaskBtn"),D.classList.add("actionImg"),D.onclick=function(){Swal.fire({title:"¿Estás seguro que quieres eliminar la tarea?",text:"Esta operación no es reversible",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Borrar"}).then(async e=>{if(e.isConfirmed&&await deleteTask(t)){let e=await getTasks();generalView&&(showTasks(e,i,o),showCalendar(e,i,o)),kanbanView&&showTasksKanban()}})};const M=document.createElement("IMG");M.title="Asignar tarea",M.src="build/img/assign_icon.svg",M.classList.add("assignTaskBtn"),M.classList.add("actionImg"),M.onclick=function(){assignmentsModal(t,i,o)};const A=document.createElement("IMG");A.title="Añadir comentario",A.src="build/img/comment_icon.svg",A.classList.add("commentTaskBtn"),A.classList.add("actionImg"),A.onclick=function(){newCommentsModal(t.id,i,o)};const S=document.createElement("DIV");S.classList.add("taskAssignContainer"),S.dataset.task_id=t.id;const T=document.createElement("H4");T.classList.add("taskAssignTitle"),T.textContent="Asignado a:";const V=document.createElement("DIV");V.classList.add("taskCollaboratorsContainer"),S.appendChild(T),S.appendChild(V);let x=new Array;n.some((function(e){return e.task_id===t.id}))?n.forEach(e=>{e.task_id===t.id&&x.push(e.user_id),viewAssignment(i,o,t,e,s,V)}):S.style.display="none";const q=document.createElement("DIV");q.classList.add("taskComments");const P=await getComments(t.id);if(P.length){const e=document.createElement("H4");e.classList.add("taskCommentsTitle"),e.textContent="Comentarios:",q.appendChild(e),P.forEach(e=>{viewComment(e,q,i,o)})}if(I.appendChild(D),I.appendChild(B),I.appendChild(M),I.appendChild(A),w.appendChild(_),w.appendChild(I),d.appendChild(w),d.appendChild(r),d.appendChild(u),d.appendChild(p),p.appendChild(g),p.appendChild(S),p.appendChild(q),a.appendChild(d),i.id!==o.user_id){w.style.display="none",D.style.display="none",B.style.display="none",A.style.display="none",M.style.display="none";document.querySelectorAll("#addTask").forEach(e=>{e.style.display="none"})}(x.includes(i.id)||o.user_id===i.id)&&(l.disabled=!1,w.style.display="block",B.style.display="block",A.style.display="block"),generalView&&(l.style.display="none"),2==t.status&&(l.checked=!0,l.disabled=!0),c(d)})}closeModalBtns.forEach((function(e){e.addEventListener("click",closeModal)}));